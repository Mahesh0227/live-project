<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MR Technologies - Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
      :root {
        --primary-color: #113C71;
        --secondary-color: #f8f9fc;
        --accent-color: #03306e;
        --success-color: #16a34a;
        --danger-color: #dc2626;
        --text-color: #333333;
        --muted-text: #6b7280;
        --white: #ffffff;

        --font-base: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        --transition-speed: 0.3s;
        --card-radius: 12px;
        --shadow-elevation: 0 4px 12px rgba(0, 0, 0, 0.1);
      }

      body {
        opacity: 0;
        transition: opacity 0.6s ease-in-out;
        font-family: var(--font-base);
        background-color: var(--secondary-color);
        color: var(--text-color);
      }

      body.loaded {
        opacity: 1;
      }

      @keyframes fadeInScale {
        0% {
          opacity: 0;
          transform: scale(0.95);
        }
        100% {
          opacity: 1;
          transform: scale(1);
        }
      }

      .animate-fadeInScale {
        animation: fadeInScale 0.6s ease-out both;
      }

      .slide-link {
        position: relative;
        overflow: hidden;
      }

      .slide-link::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: rgba(255, 255, 255, 0.1);
        transition: left var(--transition-speed) ease;
      }

      .slide-link:hover::before {
        left: 0;
      }

      .fade-up {
        opacity: 0;
        transform: translateY(20px);
        transition: all 0.6s ease-in-out;
      }

      .fade-up.show {
        opacity: 1;
        transform: translateY(0);
      }
    </style>
  </head>

  <body class="min-h-screen flex font-sans text-gray-800">
    <!-- Top Bar -->
     <body class="min-h-screen flex font-sans text-gray-800">
    <!-- Top Bar -->
    <header
      class="fixed top-0 left-0 right-0 bg-white shadow-md p-2 flex justify-between items-center z-50"
    >
      <div class="flex items-center gap-4">
        <img
          src="/images/logo.jpg"
          alt="MR Technologies Logo"
          class="w-28 h-auto object-contain animate-fadeInScale"
          style="width: 20%"
        />
        <img src="/images/Analytic hub.png" alt="" style="width: 4rem;height: 4rem;">
        <h1 class="text-2xl font-bold" style="color: var(--primary-color);"><span>Analytics Hub</span>
          
        </h1>
      </div>
      <p class="text-sm text-gray-600">
        Welcome,
        <span class="font-semibold" style="color: var(--primary-color);" id="username">
          Loading...
        </span>
      </p>
      
    </header>

  <!-- Sidebar -->
  <aside class="fixed top-[80px] left-0 w-72 bg-[var(--primary-color)] text-white " style="height: calc(100% - 80px); padding-top: 10px; z-index: 30; font-size: 20px;">
    <nav class="flex flex-col gap-4" style="margin-top: 10%;margin-left: 10%;">
      <a href="/dashboard" class="p-3 rounded slide-link">Dashboard</a>
      <a href="/courses" class="p-3 rounded slide-link">Courses</a>
      <a href="/studenthome" class="p-3 rounded slide-link">Students</a>
      <a href="/Batch" class="p-3 rounded slide-link">Batch</a>
      <a href="/payments" class="p-3 rounded slide-link">Finance</a>
      <a href="/reports" class="p-3 rounded slide-link">Reports</a>
    </nav>
    <button onclick="logout()" class="mt-4 text-left text-red-300 hover:text-white p-3 transition" style="margin-left: 10%;">Logout</button>
  </aside>

    <!-- Main Content -->
    <div class="flex-1 flex flex-col ml-72 pt-[100px]">
      <!-- Content Area -->
      <main class="p-8 flex-1 overflow-y-auto space-y-10" style="background-color: var(--secondary-color);">
        <!-- Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          <div
            class="bg-white p-6 rounded-xl shadow hover:shadow-xl transition animate-fadeInScale delay-300 flex items-center gap-4"
          >
            <i data-lucide="users" class="w-10 h-10" style="color: var(--primary-color);"></i>
            <div>
              <h3 class="text-lg font-semibold" style="color: var(--primary-color);">
                Total Students
              </h3>
              <p
                class="text-3xl mt-2 font-bold text-gray-800"
                th:text="${totalStudents}"
              >
                0
              </p>
            </div>
          </div>

          <div
            class="bg-white p-6 rounded-xl shadow hover:shadow-xl transition animate-fadeInScale delay-400 flex items-center gap-4"
          >
            <i data-lucide="wallet" class="w-10 h-10" style="color: var(--success-color);"></i>
            <div>
              <h3 class="text-lg font-semibold" style="color: var(--primary-color);">
                Total Fees Collected
              </h3>
              <p
                class="text-3xl mt-2 font-bold"
                style="color: var(--success-color);"
                th:text="'₹' + ${totalFees}"
              >
                ₹0
              </p>
            </div>
          </div>

          <div
            class="bg-white p-6 rounded-xl shadow hover:shadow-xl transition animate-fadeInScale delay-500 flex items-center gap-4"
          >
            <i data-lucide="alert-circle" class="w-10 h-10" style="color: var(--danger-color);"></i>
            <div>
              <h3 class="text-lg font-semibold" style="color: var(--primary-color);">
                Upcoming Due Payments
              </h3>
              <p
                class="text-3xl mt-2 font-bold"
                style="color: var(--danger-color);"
                th:text="'₹' + ${upcomingDue}"
              >
                ₹0
              </p>
            </div>
          </div>
        </div>

        <!-- Chart -->
        <div class="bg-white p-6 rounded-xl shadow fade-up" id="chartSection">
          <h2 class="text-xl font-semibold mb-4" style="color: var(--primary-color);">
            Monthly Fee Collection
          </h2>
          <canvas id="feeChart" width="400" height="200"></canvas>
        </div>
      </main>
    </div>

    <script>
      lucide.createIcons();

      // Page load transition
      window.addEventListener("DOMContentLoaded", () => {
        document.body.classList.add("loaded");
      });

      // Logout redirect
      function logout() {
        window.location.href = "/login";
      }

      // Load username
      fetch("http://localhost:8080/api/username", {
        credentials: "include",
      })
        .then((response) => {
          if (!response.ok) throw new Error("Not logged in");
          return response.text();
        })
        .then((username) => {
          document.getElementById("username").innerText = username;
        })
        .catch(() => {
          document.getElementById("username").innerText = "Guest";
        });

      // Scroll animation
      const fadeUpEl = document.getElementById("chartSection");
      window.addEventListener("scroll", () => {
        const rect = fadeUpEl.getBoundingClientRect();
        if (rect.top < window.innerHeight - 100) {
          fadeUpEl.classList.add("show");
        }
      });

      // Chart.js
      const ctx = document.getElementById("feeChart").getContext("2d");
      const feeChart = new Chart(ctx, {
        type: "bar",
        data: {
          labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul"],
          datasets: [
            {
              label: "Fees Collected (₹)",
              data: [40000, 60000, 55000, 75000, 68000, 72000, 80000],
              backgroundColor: getComputedStyle(document.documentElement).getPropertyValue('--primary-color').trim(),
              borderRadius: 8,
            },
          ],
        },
        options: {
          responsive: true,
          animation: {
            duration: 1200,
            easing: "easeOutBounce",
          },
          scales: {
            y: {
              beginAtZero: true,
            },
          },
        },
      });
    </script>
  </body>
</html>
